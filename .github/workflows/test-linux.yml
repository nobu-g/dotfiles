name: test-linux

on: [push]

jobs:
  ubuntu:
    runs-on: ubuntu-latest
    container: ubuntu:latest
    steps:
      # - uses: actions/checkout@v2
      - name: Install required packages
        run: apt-get update && apt-get -y upgrade && apt-get install -y build-essential procps curl file git gcc sudo make zsh wget python3-pip unzip gettext
      - name: Clone this repo
        run: git clone --depth 1 https://github.com/nobu-g/dotfiles.git
      - name: Install dotfiles
        run: make install
        working-directory: ./dotfiles
    env:
      DEBIAN_FRONTEND: noninteractive

  centos:
    runs-on: ubuntu-latest
    container: centos:latest
    steps:
      - name: Install required packages
        run: yum install -y build-essential procps-ng curl file git gcc sudo make zsh wget unzip gettext perl-ExtUtils-MakeMaker
      - name: Clone this repo
        run: git clone --depth 1 https://github.com/nobu-g/dotfiles.git
      - name: Install dotfiles
        run: make install
        working-directory: ./dotfiles

  fedora:
    runs-on: ubuntu-latest
    container: fedora:latest
    steps:
      - name: Install required packages
        run: dnf clean all && dnf install -y build-essential procps-ng curl file git gcc sudo make zsh wget python3-pip unzip gettext libxcrypt-compat
      - name: Clone this repo
        run: git clone --depth 1 https://github.com/nobu-g/dotfiles.git
      - name: Install dotfiles
        run: make install
        working-directory: ./dotfiles

  alpine:
    runs-on: ubuntu-latest
    container: alpine:latest
    steps:
      - name: Install required packages
        run: apk add --no-cache bash bc coreutils curl file g++ gawk gcc gettext git grep libc-dev make procps ruby ruby-bigdecimal ruby-etc ruby-fiddle ruby-irb ruby-json ruby-test-unit sqlite sudo unzip wget zsh
      - name: Clone this repo
        run: git clone --depth 1 https://github.com/nobu-g/dotfiles.git
      - name: Install dotfiles
        run: make install
        working-directory: ./dotfiles
