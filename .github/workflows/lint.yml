name: lint

on: [push]

jobs:
  lint:
    runs-on: ubuntu-latest
    container: ubuntu:latest
    steps:
      - uses: actions/checkout@v2
      - name: Update packages
        run: apt-get update
      - name: Install packages for install repository
        run: DEBIAN_FRONTEND=noninteractive apt-get install -y git sudo software-properties-common python3-pip
      - name: Install required repository
        run: apt-add-repository "deb http://archive.ubuntu.com/ubuntu trusty-backports main restricted universe"
      - name: Install required packages
        run: apt-get update && apt-get install -y shellcheck
      # - name: Execute shellcheck (zsh)
      #   run: test $(find ./.zsh.d/ -type f | grep -v .zsh.d/functions | xargs shellcheck -f gcc --exclude=SC1036,SC1056,SC1072,SC1073,SC1090,SC2139,SC2206,SC2034,SC2148,SC2016,SC2086,SC2128,SC2068,SC2155,SC2001 | tee -a /dev/stderr | wc -l) -le 1
      # - name: Execute shellcheck (zsh functions)
      #   run: test $(find ./.zsh.d/functions -type f | xargs shellcheck -f gcc --exclude=SC1036,SC1056,SC1072,SC1073,SC1090,SC2139,SC2206,SC2034,SC2148,SC2016,SC2086,SC2128,SC2068,SC2155,SC2001,SC2168 | tee -a /dev/stderr | wc -l) -le 1
      - name: Execute shellcheck (installer)
        run: test $(git ls-files | grep "\.sh$" | xargs shellcheck -f gcc --exclude=SC1090,SC2086 | tee -a /dev/stderr | wc -l) -le 0
